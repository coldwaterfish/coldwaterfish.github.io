{"version":3,"file":"static/js/899.ed371cf1.chunk.js","mappings":"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","sources":["pages/main/article-list/index.tsx"],"sourcesContent":["import { memo, useEffect, useState } from \"react\";\r\n\r\nimport { handleArticleList } from \"api/index\";\r\nimport { Button, Form, Input, Modal, Space, Table, DatePicker } from \"antd\";\r\nimport { ColumnsType } from \"antd/lib/table\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\n\r\nimport \"./index.less\";\r\nimport { PlusOutlined, SearchOutlined } from \"@ant-design/icons\";\r\nimport moment from \"moment\";\r\n\r\nconst { RangePicker } = DatePicker;\r\n\r\nexport interface article {\r\n  key: number;\r\n  title: string;\r\n  createTime: string;\r\n  updateTime: string;\r\n}\r\n\r\n// 组件\r\nconst ArticleList = () => {\r\n  // 文章列表-初始数据\r\n  const [articleList, setArticleList] = useState<article[]>([]);\r\n\r\n  // 文章列表-copy\r\n  const [articleListCopy, setArticleListCopy] = useState<article[]>([]);\r\n\r\n  // 对话框-删除\r\n  const [isDeleteModal, setIsDeleteModal] = useState(false);\r\n\r\n  // 点击的文章-编辑/删除\r\n  const [selectArticle, setSelectArticle] = useState<article>();\r\n\r\n  // router\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  // search-form\r\n  const [form] = Form.useForm();\r\n\r\n  // 根据窗口宽度调整search-form的布局\r\n  const [formLayout, setFormLayout] = useState<\r\n    \"horizontal\" | \"vertical\" | \"inline\"\r\n  >(\"inline\");\r\n\r\n  // effect\r\n  useEffect(() => {\r\n    (async function () {\r\n      const result = await handleArticleList(location.pathname);\r\n      if (result && result.data.articleList) {\r\n        setArticleList(result.data.articleList);\r\n        setArticleListCopy(result.data.articleList);\r\n      }\r\n    })();\r\n  }, []); // eslint-disable-line\r\n\r\n  // 点击id,跳转文章详情\r\n  const idClick = (text: number) => {\r\n    return () => {\r\n      navigate(`${location.pathname}/article`, {\r\n        state: { key: text },\r\n      });\r\n    };\r\n  };\r\n\r\n  // 编辑\r\n  const onEdit = (record: article) => {\r\n    return () => {\r\n      console.log(record);\r\n    };\r\n  };\r\n\r\n  // 删除\r\n  const onDelete = (record: article) => {\r\n    return () => {\r\n      setIsDeleteModal(true);\r\n      setSelectArticle(record);\r\n    };\r\n  };\r\n\r\n  // 确认删除\r\n  const handleDeleteOk = () => {\r\n    const arr = [...articleList];\r\n    const index = articleList.findIndex((item) => item === selectArticle);\r\n    arr.splice(index, 1);\r\n    setArticleList(arr);\r\n    setIsDeleteModal(false);\r\n  };\r\n\r\n  // 取消删除\r\n  const handleDeleteCancel = () => {\r\n    setIsDeleteModal(false);\r\n  };\r\n\r\n  // 列表搜索\r\n  const onSearch = (values: any) => {\r\n    const { articleKey, articleTitle, articleDateTime } = values;\r\n    let filterList = articleListCopy.filter((item) => {\r\n      let isKey = true;\r\n      if (articleKey) {\r\n        isKey = item.key.toString().includes(articleKey);\r\n      }\r\n      let isTitle = true;\r\n      if (articleTitle) {\r\n        isTitle = item.title.includes(articleTitle);\r\n      }\r\n      let isDateTime = true;\r\n      if (articleDateTime) {\r\n        isDateTime =\r\n          articleDateTime[1] >= moment(item.createTime) &&\r\n          moment(item.createTime) >= articleDateTime[0];\r\n      }\r\n      return isKey && isTitle && isDateTime;\r\n    });\r\n    setArticleList(filterList);\r\n  };\r\n\r\n  // 设置表格的layout\r\n  const setSearchFormLayout = () => {\r\n    let width =\r\n      window.innerWidth || //浏览器窗口的内部宽度（包括滚动条）\r\n      document.documentElement.clientWidth ||\r\n      document.body.clientWidth;\r\n    if (width < 768) {\r\n      setFormLayout(\"vertical\");\r\n    } else {\r\n      setFormLayout(\"inline\");\r\n    }\r\n  };\r\n  // effect\r\n  useEffect(() => {\r\n    setSearchFormLayout();\r\n    return () => {\r\n      window.removeEventListener(\"resize\", setSearchFormLayout, false);\r\n    };\r\n  }, []); // eslint-disable-line\r\n\r\n  // 监听窗口宽度\r\n  window.addEventListener(\"resize\", setSearchFormLayout, false);\r\n  // 表格的标题\r\n  const columns: ColumnsType<article> = [\r\n    {\r\n      title: \"编号\",\r\n      dataIndex: \"key\",\r\n      key: \"key\",\r\n      render: (text: number) => (\r\n        <Button\r\n          onClick={idClick(text)}\r\n          type=\"text\"\r\n          style={{ color: \"#1890ff\" }}\r\n        >\r\n          {text}\r\n        </Button>\r\n      ),\r\n      // 添加默认排序，初始显示会有黑色背景\r\n      // defaultSortOrder: \"ascend\",\r\n      sorter: (a, b) => a.key - b.key,\r\n    },\r\n    {\r\n      title: \"标题\",\r\n      dataIndex: \"title\",\r\n      key: \"title\",\r\n    },\r\n    {\r\n      title: \"创建日期\",\r\n      dataIndex: \"createTime\",\r\n      key: \"createTime\",\r\n      // 响应式-显示/隐藏\r\n      responsive: [\"md\"],\r\n    },\r\n    {\r\n      title: \"修改日期\",\r\n      dataIndex: \"updateTime\",\r\n      key: \"updateTime\",\r\n      responsive: [\"md\"],\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      dataIndex: \"action\",\r\n      key: \"action\",\r\n      render: (text, record) => {\r\n        return (\r\n          <Space size=\"middle\">\r\n            <Button onClick={onEdit(record)} type=\"primary\" size=\"small\">\r\n              编辑\r\n            </Button>\r\n            <Button onClick={onDelete(record)} type=\"primary\" size=\"small\">\r\n              删除\r\n            </Button>\r\n          </Space>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n  return (\r\n    <>\r\n      <Modal\r\n        title=\"提示：\"\r\n        visible={isDeleteModal}\r\n        onOk={handleDeleteOk}\r\n        onCancel={handleDeleteCancel}\r\n      >\r\n        <p>\r\n          确认删除 : {selectArticle?.key} {selectArticle?.title} ?\r\n        </p>\r\n      </Modal>\r\n      <div className=\"header\">\r\n        <Form\r\n          name=\"search-form\"\r\n          onFinish={onSearch}\r\n          form={form}\r\n          layout={formLayout}\r\n        >\r\n          <Form.Item name=\"articleKey\">\r\n            <Input style={{ width: \"200px\" }} placeholder=\"编号\" />\r\n          </Form.Item>\r\n          <Form.Item name=\"articleTitle\">\r\n            <Input style={{ width: \"200px\" }} placeholder=\"标题\" />\r\n          </Form.Item>\r\n          <Form.Item name=\"articleDateTime\">\r\n            <RangePicker />\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Button type=\"primary\" htmlType=\"submit\" icon={<SearchOutlined />}>\r\n              搜索\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n        <Button type=\"primary\" htmlType=\"submit\" icon={<PlusOutlined />}>\r\n          添加\r\n        </Button>\r\n      </div>\r\n      <Table<article>\r\n        columns={columns}\r\n        dataSource={articleList}\r\n        className=\"articleTable\"\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default memo(ArticleList);\r\n"],"names":["RangePicker","ArticleList","useState","articleList","setArticleList","articleListCopy","setArticleListCopy","isDeleteModal","setIsDeleteModal","selectArticle","setSelectArticle","navigate","useNavigate","location","useLocation","form","formLayout","setFormLayout","useEffect","handleArticleList","pathname","result","data","idClick","text","state","key","onEdit","record","console","log","onDelete","setSearchFormLayout","width","window","innerWidth","document","documentElement","clientWidth","body","removeEventListener","addEventListener","columns","title","dataIndex","render","onClick","type","style","color","sorter","a","b","responsive","size","visible","onOk","arr","index","findIndex","item","splice","onCancel","className","name","onFinish","values","articleKey","articleTitle","articleDateTime","filterList","filter","isKey","toString","includes","isTitle","isDateTime","moment","createTime","layout","placeholder","htmlType","icon","SearchOutlined","PlusOutlined","dataSource","memo"],"sourceRoot":""}